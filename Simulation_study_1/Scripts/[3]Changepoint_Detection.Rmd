---
title: "Changepoint Detection"
author: "Hsuan Lee"
output: pdf_document
---

```{r}
library(ocp) # package for BOCD
library(changepoint) # package for PELT, BS
```

```{r}
setwd(paste("C:/Users/HsuanLee/Desktop/Methodology and Statistics/",
"Changepoints Inference in Relational Event Data of a Social Network/",
"ResearchArchive/Simulation_study_1", sep = ""))
```

# No Changepoint REH Data

**Read the Parameters given by windows**

Sender Effect:
```{r}
fixmw_send_ncp_param <- readRDS("../Data/Window_Parameters/fixmw_send_ncp_param.RDS")
```

Difference Effect: 
```{r}
fixmw_diff_ncp_param <- readRDS("../Data/Window_Parameters/fixmw_diff_ncp_param.RDS")
```

Inertia:
```{r}
fixmw_ine_ncp_param <- readRDS("../Data/Window_Parameters/fixmw_ine_ncp_param.RDS")
```

Out Degree Sender Effect:
```{r}
fixmw_out_ncp_param <- readRDS("../Data/Window_Parameters/fixmw_out_ncp_param.RDS")
```

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
# Detect the CPs
BOCD_fixmw_send_ncp_param <- list()
start_time <- Sys.time()
for (i in 1:length(fixmw_send_ncp_param)) {
  BOCD_fixmw_send_ncp_param[[i]] <- onlineCPD(fixmw_send_ncp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}
end_time <- Sys.time()
BOCD_ncp_send_operation_time <- end_time - start_time
print(paste("Operation time:", BOCD_ncp_send_operation_time))

# location of the CPs
locat_BOCD_ncp_send <- list()
for (i in 1:length(BOCD_fixmw_send_ncp_param)) {
  locat_BOCD_ncp_send[[i]] <- BOCD_fixmw_send_ncp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_ncp_send[[i]] <- locat_BOCD_ncp_send[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_send_ncp_param)) {
  plot(BOCD_fixmw_send_ncp_param[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_ncp_send, file = "../Output/CP_Detection/locat_BOCD_ncp_send.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_diff_ncp_param <- list()
start_time <- Sys.time()
for (i in 1:length(fixmw_diff_ncp_param)) {
  BOCD_fixmw_diff_ncp_param[[i]] <- onlineCPD(fixmw_diff_ncp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}
end_time <- Sys.time()
BOCD_ncp_diff_operation_time <- end_time - start_time
print(paste("Operation time:", BOCD_ncp_diff_operation_time))

# location of the CPs
locat_BOCD_ncp_diff <- list()
for (i in 1:length(BOCD_fixmw_diff_ncp_param)) {
  locat_BOCD_ncp_diff[[i]] <- BOCD_fixmw_diff_ncp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_ncp_diff[[i]] <- locat_BOCD_ncp_diff[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_diff_ncp_param)) {
  plot(BOCD_fixmw_diff_ncp_param[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_ncp_diff, file = "../Output/CP_Detection/locat_BOCD_ncp_diff.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_ine_ncp_param <- list()
start_time <- Sys.time()
for (i in 1:length(fixmw_ine_ncp_param)) {
  BOCD_fixmw_ine_ncp_param[[i]] <- onlineCPD(fixmw_ine_ncp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}
end_time <- Sys.time()
BOCD_ncp_ine_operation_time <- end_time - start_time
print(paste("Operation time:", BOCD_ncp_ine_operation_time))

# location of the CPs
locat_BOCD_ncp_ine <- list()
for (i in 1:length(BOCD_fixmw_ine_ncp_param)) {
  locat_BOCD_ncp_ine[[i]] <- BOCD_fixmw_ine_ncp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_ncp_ine[[i]] <- locat_BOCD_ncp_ine[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_ine_ncp_param)) {
  plot(BOCD_fixmw_ine_ncp_param[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_ncp_ine, file = "../Output/CP_Detection/locat_BOCD_ncp_ine.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_out_ncp_param <- list()
start_time <- Sys.time()
for (i in 1:length(fixmw_out_ncp_param)) {
  BOCD_fixmw_out_ncp_param[[i]] <- onlineCPD(fixmw_out_ncp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}
end_time <- Sys.time()
BOCD_ncp_out_operation_time <- end_time - start_time
print(paste("Operation time:", BOCD_ncp_out_operation_time))

# location of the CPs
locat_BOCD_ncp_out <- list()
for (i in 1:length(BOCD_fixmw_out_ncp_param)) {
  locat_BOCD_ncp_out[[i]] <- BOCD_fixmw_out_ncp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_ncp_out[[i]] <- locat_BOCD_ncp_out[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_out_ncp_param)) {
  plot(BOCD_fixmw_out_ncp_param[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_ncp_out, file = "../Output/CP_Detection/locat_BOCD_ncp_out.RDS")
```

2. PELT: Exact CPs Detection Method
```{r}
# detect the changepoints
PELT_fixmw_send_ncp_param <- list()
start_time <- Sys.time()
for (i in 1:length(fixmw_out_ncp_param)) {
  PELT_fixmw_send_ncp_param[[i]] <- cpt.meanvar(fixmw_send_ncp_param[[i]], method="PELT")
}
end_time <- Sys.time()
PELT_ncp_send_operation_time <- end_time - start_time
print(paste("Operation time:", PELT_ncp_send_operation_time))

# location of the changepoints
locat_PELT_ncp_send <- list()
for (i in 1:length(PELT_fixmw_send_ncp_param)) {
  locat_PELT_ncp_send[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_send_ncp_param[[i]]@cpts[-length(PELT_fixmw_send_ncp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_send_ncp_param)) {
  plot(PELT_fixmw_send_ncp_param[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_send_ncp_param[[i]]@cpts[-length(PELT_fixmw_send_ncp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_ncp_send, file = "../Output/CP_Detection/locat_PELT_ncp_send.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_diff_ncp_param <- list()
start_time <- Sys.time()
for (i in 1:length(fixmw_out_ncp_param)) {
  PELT_fixmw_diff_ncp_param[[i]] <- cpt.meanvar(fixmw_diff_ncp_param[[i]], method="PELT")
}
end_time <- Sys.time()
PELT_ncp_diff_operation_time <- end_time - start_time
print(paste("Operation time:", PELT_ncp_diff_operation_time))

# location of the changepoints
locat_PELT_ncp_diff <- list()
for (i in 1:length(PELT_fixmw_diff_ncp_param)) {
  locat_PELT_ncp_diff[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_diff_ncp_param[[i]]@cpts[-length(PELT_fixmw_diff_ncp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_diff_ncp_param)) {
  plot(PELT_fixmw_diff_ncp_param[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_diff_ncp_param[[i]]@cpts[-length(PELT_fixmw_diff_ncp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_ncp_diff, file = "../Output/CP_Detection/locat_PELT_ncp_diff.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_ine_ncp_param <- list()
start_time <- Sys.time()
for (i in 1:length(fixmw_out_ncp_param)) {
  PELT_fixmw_ine_ncp_param[[i]] <- cpt.meanvar(fixmw_ine_ncp_param[[i]], method="PELT")
}
end_time <- Sys.time()
PELT_ncp_ine_operation_time <- end_time - start_time
print(paste("Operation time:", PELT_ncp_ine_operation_time))

# location of the changepoints
locat_PELT_ncp_ine <- list()
for (i in 1:length(PELT_fixmw_ine_ncp_param)) {
  locat_PELT_ncp_ine[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_ine_ncp_param[[i]]@cpts[-length(PELT_fixmw_ine_ncp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_ine_ncp_param)) {
  plot(PELT_fixmw_ine_ncp_param[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_ine_ncp_param[[i]]@cpts[-length(PELT_fixmw_ine_ncp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_ncp_ine, file = "../Output/CP_Detection/locat_PELT_ncp_ine.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_out_ncp_param <- list()
start_time <- Sys.time()
for (i in 1:length(fixmw_out_ncp_param)) {
  PELT_fixmw_out_ncp_param[[i]] <- cpt.meanvar(fixmw_out_ncp_param[[i]], method="PELT")
}
end_time <- Sys.time()
PELT_ncp_out_operation_time <- end_time - start_time
print(paste("Operation time:", PELT_ncp_out_operation_time))
# location of the changepoints
locat_PELT_ncp_out <- list()
for (i in 1:length(PELT_fixmw_out_ncp_param)) {
  locat_PELT_ncp_out[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_out_ncp_param[[i]]@cpts[-length(PELT_fixmw_out_ncp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_out_ncp_param)) {
  plot(PELT_fixmw_out_ncp_param[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_out_ncp_param[[i]]@cpts[-length(PELT_fixmw_out_ncp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_ncp_out, file = "../Output/CP_Detection/locat_PELT_ncp_out.RDS")
```

3. BS: approximate CPs Detection Method
```{r}
# detect the changepoints
BS_fixmw_send_ncp_param <- list()
start_time <- Sys.time()
for (i in 1:length(fixmw_out_ncp_param)) {
  BS_fixmw_send_ncp_param[[i]] <- cpt.meanvar(fixmw_send_ncp_param[[i]], method="BinSeg")
}
end_time <- Sys.time()
BS_ncp_send_operation_time <- end_time - start_time
print(paste("Operation time:", BS_ncp_send_operation_time))

# location of the changepoints
locat_BS_ncp_send <- list()
for (i in 1:length(BS_fixmw_send_ncp_param)) {
  locat_BS_ncp_send[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_send_ncp_param[[i]]@cpts[-length(BS_fixmw_send_ncp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_send_ncp_param)) {
  plot(BS_fixmw_send_ncp_param[[i]], type="point", col = "black")
  abline(v=BS_fixmw_send_ncp_param[[i]]@cpts[-length(BS_fixmw_send_ncp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_ncp_send, file = "../Output/CP_Detection/locat_BS_ncp_send.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_diff_ncp_param <- list()
start_time <- Sys.time()
for (i in 1:length(fixmw_out_ncp_param)) {
  BS_fixmw_diff_ncp_param[[i]] <- cpt.meanvar(fixmw_diff_ncp_param[[i]], method="BinSeg")
}
end_time <- Sys.time()
BS_ncp_diff_operation_time <- end_time - start_time
print(paste("Operation time:", BS_ncp_diff_operation_time))

# location of the changepoints
locat_BS_ncp_diff <- list()
for (i in 1:length(BS_fixmw_diff_ncp_param)) {
  locat_BS_ncp_diff[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_diff_ncp_param[[i]]@cpts[-length(BS_fixmw_diff_ncp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_diff_ncp_param)) {
  plot(BS_fixmw_diff_ncp_param[[i]], type="point", col = "black")
  abline(v=BS_fixmw_diff_ncp_param[[i]]@cpts[-length(BS_fixmw_diff_ncp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_ncp_diff, file = "../Output/CP_Detection/locat_BS_ncp_diff.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_ine_ncp_param <- list()
start_time <- Sys.time()
for (i in 1:length(fixmw_out_ncp_param)) {
  BS_fixmw_ine_ncp_param[[i]] <- cpt.meanvar(fixmw_ine_ncp_param[[i]], method="BinSeg")
}
end_time <- Sys.time()
BS_ncp_ine_operation_time <- end_time - start_time
print(paste("Operation time:", BS_ncp_ine_operation_time))

# location of the changepoints
locat_BS_ncp_ine <- list()
for (i in 1:length(BS_fixmw_ine_ncp_param)) {
  locat_BS_ncp_ine[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_ine_ncp_param[[i]]@cpts[-length(BS_fixmw_ine_ncp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_ine_ncp_param)) {
  plot(BS_fixmw_ine_ncp_param[[i]], type="point", col = "black")
  abline(v=BS_fixmw_ine_ncp_param[[i]]@cpts[-length(BS_fixmw_ine_ncp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_ncp_ine, file = "../Output/CP_Detection/locat_BS_ncp_ine.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_out_ncp_param <- list()
start_time <- Sys.time()
for (i in 1:length(fixmw_out_ncp_param)) {
  BS_fixmw_out_ncp_param[[i]] <- cpt.meanvar(fixmw_out_ncp_param[[i]], method="BinSeg")
}
end_time <- Sys.time()
BS_ncp_out_operation_time <- end_time - start_time
print(paste("Operation time:", BS_ncp_out_operation_time))

# location of the changepoints
locat_BS_ncp_out <- list()
for (i in 1:length(BS_fixmw_out_ncp_param)) {
  locat_BS_ncp_out[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_out_ncp_param[[i]]@cpts[-length(BS_fixmw_out_ncp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_out_ncp_param)) {
  plot(BS_fixmw_out_ncp_param[[i]], type="point", col = "black")
  abline(v=BS_fixmw_out_ncp_param[[i]]@cpts[-length(BS_fixmw_out_ncp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_ncp_out, file = "../Output/CP_Detection/locat_BS_ncp_out.RDS")
```

# 1 Changepoint REH Data (inertia only)

**Read the Parameters given by windows**

Sender Effect:
```{r}
fixmw_send_1cp_param <- readRDS("../Data/Window_Parameters/fixmw_send_1cp_param.RDS")
```

Difference Effect: 
```{r}
fixmw_diff_1cp_param <- readRDS("../Data/Window_Parameters/fixmw_diff_1cp_param.RDS")
```

Inertia:
```{r}
fixmw_ine_1cp_param <- readRDS("../Data/Window_Parameters/fixmw_ine_1cp_param.RDS")
```

Out Degree Sender Effect:
```{r}
fixmw_out_1cp_param <- readRDS("../Data/Window_Parameters/fixmw_out_1cp_param.RDS")
```

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
# Detect the CPs
BOCD_fixmw_send_1cp_param <- list()
for (i in 1:length(fixmw_send_1cp_param)) {
  BOCD_fixmw_send_1cp_param[[i]] <- onlineCPD(fixmw_send_1cp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_send <- list()
for (i in 1:length(BOCD_fixmw_send_1cp_param)) {
  locat_BOCD_1cp_send[[i]] <- BOCD_fixmw_send_1cp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_1cp_send[[i]] <- locat_BOCD_1cp_send[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_send_1cp_param)) {
  plot(BOCD_fixmw_send_1cp_param[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_1cp_send, file = "../Output/CP_Detection/locat_BOCD_1cp_send.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_diff_1cp_param <- list()
for (i in 1:length(fixmw_diff_1cp_param)) {
  BOCD_fixmw_diff_1cp_param[[i]] <- onlineCPD(fixmw_diff_1cp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_diff <- list()
for (i in 1:length(BOCD_fixmw_diff_1cp_param)) {
  locat_BOCD_1cp_diff[[i]] <- BOCD_fixmw_diff_1cp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_1cp_diff[[i]] <- locat_BOCD_1cp_diff[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_diff_1cp_param)) {
  plot(BOCD_fixmw_diff_1cp_param[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_1cp_diff, file = "../Output/CP_Detection/locat_BOCD_1cp_diff.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_ine_1cp_param <- list()
for (i in 1:length(fixmw_ine_1cp_param)) {
  BOCD_fixmw_ine_1cp_param[[i]] <- onlineCPD(fixmw_ine_1cp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_ine <- list()
for (i in 1:length(BOCD_fixmw_ine_1cp_param)) {
  locat_BOCD_1cp_ine[[i]] <- BOCD_fixmw_ine_1cp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_1cp_ine[[i]] <- locat_BOCD_1cp_ine[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_ine_1cp_param)) {
  plot(BOCD_fixmw_ine_1cp_param[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_1cp_ine, file = "../Output/CP_Detection/locat_BOCD_1cp_ine.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_out_1cp_param <- list()
for (i in 1:length(fixmw_out_1cp_param)) {
  BOCD_fixmw_out_1cp_param[[i]] <- onlineCPD(fixmw_out_1cp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_out <- list()
for (i in 1:length(BOCD_fixmw_out_1cp_param)) {
  locat_BOCD_1cp_out[[i]] <- BOCD_fixmw_out_1cp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_1cp_out[[i]] <- locat_BOCD_1cp_out[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_out_1cp_param)) {
  plot(BOCD_fixmw_out_1cp_param[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_1cp_out, file = "../Output/CP_Detection/locat_BOCD_1cp_out.RDS")
```

2. PELT: Exact CPs Detection Method
```{r}
# detect the changepoints
PELT_fixmw_send_1cp_param <- list()
for (i in 1:length(fixmw_out_1cp_param)) {
  PELT_fixmw_send_1cp_param[[i]] <- cpt.meanvar(fixmw_send_1cp_param[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_1cp_send <- list()
for (i in 1:length(PELT_fixmw_send_1cp_param)) {
  locat_PELT_1cp_send[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_send_1cp_param[[i]]@cpts[-length(PELT_fixmw_send_1cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_send_1cp_param)) {
  plot(PELT_fixmw_send_1cp_param[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_send_1cp_param[[i]]@cpts[-length(PELT_fixmw_send_1cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_1cp_send, file = "../Output/CP_Detection/locat_PELT_1cp_send.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_diff_1cp_param <- list()
for (i in 1:length(fixmw_out_1cp_param)) {
  PELT_fixmw_diff_1cp_param[[i]] <- cpt.meanvar(fixmw_diff_1cp_param[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_1cp_diff <- list()
for (i in 1:length(PELT_fixmw_diff_1cp_param)) {
  locat_PELT_1cp_diff[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_diff_1cp_param[[i]]@cpts[-length(PELT_fixmw_diff_1cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_diff_1cp_param)) {
  plot(PELT_fixmw_diff_1cp_param[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_diff_1cp_param[[i]]@cpts[-length(PELT_fixmw_diff_1cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_1cp_diff, file = "../Output/CP_Detection/locat_PELT_1cp_diff.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_ine_1cp_param <- list()
for (i in 1:length(fixmw_out_1cp_param)) {
  PELT_fixmw_ine_1cp_param[[i]] <- cpt.meanvar(fixmw_ine_1cp_param[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_1cp_ine <- list()
for (i in 1:length(PELT_fixmw_ine_1cp_param)) {
  locat_PELT_1cp_ine[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_ine_1cp_param[[i]]@cpts[-length(PELT_fixmw_ine_1cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_ine_1cp_param)) {
  plot(PELT_fixmw_ine_1cp_param[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_ine_1cp_param[[i]]@cpts[-length(PELT_fixmw_ine_1cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_1cp_ine, file = "../Output/CP_Detection/locat_PELT_1cp_ine.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_out_1cp_param <- list()
for (i in 1:length(fixmw_out_1cp_param)) {
  PELT_fixmw_out_1cp_param[[i]] <- cpt.meanvar(fixmw_out_1cp_param[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_1cp_out <- list()
for (i in 1:length(PELT_fixmw_out_1cp_param)) {
  locat_PELT_1cp_out[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_out_1cp_param[[i]]@cpts[-length(PELT_fixmw_out_1cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_out_1cp_param)) {
  plot(PELT_fixmw_out_1cp_param[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_out_1cp_param[[i]]@cpts[-length(PELT_fixmw_out_1cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_1cp_out, file = "../Output/CP_Detection/locat_PELT_1cp_out.RDS")
```

3. BS: approximate CPs Detection Method
```{r}
# detect the changepoints
BS_fixmw_send_1cp_param <- list()
for (i in 1:length(fixmw_out_1cp_param)) {
  BS_fixmw_send_1cp_param[[i]] <- cpt.meanvar(fixmw_send_1cp_param[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_1cp_send <- list()
for (i in 1:length(BS_fixmw_send_1cp_param)) {
  locat_BS_1cp_send[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_send_1cp_param[[i]]@cpts[-length(BS_fixmw_send_1cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_send_1cp_param)) {
  plot(BS_fixmw_send_1cp_param[[i]], type="point", col = "black")
  abline(v=BS_fixmw_send_1cp_param[[i]]@cpts[-length(BS_fixmw_send_1cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_1cp_send, file = "../Output/CP_Detection/locat_BS_1cp_send.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_diff_1cp_param <- list()
for (i in 1:length(fixmw_out_1cp_param)) {
  BS_fixmw_diff_1cp_param[[i]] <- cpt.meanvar(fixmw_diff_1cp_param[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_1cp_diff <- list()
for (i in 1:length(BS_fixmw_diff_1cp_param)) {
  locat_BS_1cp_diff[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_diff_1cp_param[[i]]@cpts[-length(BS_fixmw_diff_1cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_diff_1cp_param)) {
  plot(BS_fixmw_diff_1cp_param[[i]], type="point", col = "black")
  abline(v=BS_fixmw_diff_1cp_param[[i]]@cpts[-length(BS_fixmw_diff_1cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_1cp_diff, file = "../Output/CP_Detection/locat_BS_1cp_diff.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_ine_1cp_param <- list()
for (i in 1:length(fixmw_out_1cp_param)) {
  BS_fixmw_ine_1cp_param[[i]] <- cpt.meanvar(fixmw_ine_1cp_param[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_1cp_ine <- list()
for (i in 1:length(BS_fixmw_ine_1cp_param)) {
  locat_BS_1cp_ine[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_ine_1cp_param[[i]]@cpts[-length(BS_fixmw_ine_1cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_ine_1cp_param)) {
  plot(BS_fixmw_ine_1cp_param[[i]], type="point", col = "black")
  abline(v=BS_fixmw_ine_1cp_param[[i]]@cpts[-length(BS_fixmw_ine_1cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_1cp_ine, file = "../Output/CP_Detection/locat_BS_1cp_ine.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_out_1cp_param <- list()
for (i in 1:length(fixmw_out_1cp_param)) {
  BS_fixmw_out_1cp_param[[i]] <- cpt.meanvar(fixmw_out_1cp_param[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_1cp_out <- list()
for (i in 1:length(BS_fixmw_out_1cp_param)) {
  locat_BS_1cp_out[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_out_1cp_param[[i]]@cpts[-length(BS_fixmw_out_1cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_out_1cp_param)) {
  plot(BS_fixmw_out_1cp_param[[i]], type="point", col = "black")
  abline(v=BS_fixmw_out_1cp_param[[i]]@cpts[-length(BS_fixmw_out_1cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_1cp_out, file = "../Output/CP_Detection/locat_BS_1cp_out.RDS")
```

# 1 Changepoint REH Data (all social interaction drivers at same locations)

**Read the Parameters given by windows**

Sender Effect:
```{r}
fixmw_send_1cp_param_same.all <- readRDS("../Data/Window_Parameters/fixmw_send_1cp_param_same.all.RDS")
```

Difference Effect: 
```{r}
fixmw_diff_1cp_param_same.all <- readRDS("../Data/Window_Parameters/fixmw_diff_1cp_param_same.all.RDS")
```

Inertia:
```{r}
fixmw_ine_1cp_param_same.all <- readRDS("../Data/Window_Parameters/fixmw_ine_1cp_param_same.all.RDS")
```

Out Degree Sender Effect:
```{r}
fixmw_out_1cp_param_same.all <- readRDS("../Data/Window_Parameters/fixmw_out_1cp_param_same.all.RDS")
```

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
# Detect the CPs
BOCD_fixmw_send_1cp_param_same.all <- list()
for (i in 1:length(fixmw_send_1cp_param_same.all)) {
  BOCD_fixmw_send_1cp_param_same.all[[i]] <- onlineCPD(fixmw_send_1cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_send_same.all <- list()
for (i in 1:length(BOCD_fixmw_send_1cp_param_same.all)) {
  locat_BOCD_1cp_send_same.all[[i]] <- BOCD_fixmw_send_1cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_1cp_send_same.all[[i]] <- locat_BOCD_1cp_send_same.all[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_send_1cp_param_same.all)) {
  plot(BOCD_fixmw_send_1cp_param_same.all[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_1cp_send_same.all, file = "../Output/CP_Detection/locat_BOCD_1cp_send_same.all.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_diff_1cp_param_same.all <- list()
for (i in 1:length(fixmw_diff_1cp_param_same.all)) {
  BOCD_fixmw_diff_1cp_param_same.all[[i]] <- onlineCPD(fixmw_diff_1cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_diff_same.all <- list()
for (i in 1:length(BOCD_fixmw_diff_1cp_param_same.all)) {
  locat_BOCD_1cp_diff_same.all[[i]] <- BOCD_fixmw_diff_1cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_1cp_diff_same.all[[i]] <- locat_BOCD_1cp_diff_same.all[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_diff_1cp_param_same.all)) {
  plot(BOCD_fixmw_diff_1cp_param_same.all[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_1cp_diff_same.all, file = "../Output/CP_Detection/locat_BOCD_1cp_diff_same.all.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_ine_1cp_param_same.all <- list()
for (i in 1:length(fixmw_ine_1cp_param_same.all)) {
  BOCD_fixmw_ine_1cp_param_same.all[[i]] <- onlineCPD(fixmw_ine_1cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_ine_same.all <- list()
for (i in 1:length(BOCD_fixmw_ine_1cp_param_same.all)) {
  locat_BOCD_1cp_ine_same.all[[i]] <- BOCD_fixmw_ine_1cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_1cp_ine_same.all[[i]] <- locat_BOCD_1cp_ine_same.all[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_ine_1cp_param_same.all)) {
  plot(BOCD_fixmw_ine_1cp_param_same.all[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_1cp_ine_same.all, file = "../Output/CP_Detection/locat_BOCD_1cp_ine_same.all.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_out_1cp_param_same.all <- list()
for (i in 1:length(fixmw_out_1cp_param_same.all)) {
  BOCD_fixmw_out_1cp_param_same.all[[i]] <- onlineCPD(fixmw_out_1cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_out_same.all <- list()
for (i in 1:length(BOCD_fixmw_out_1cp_param_same.all)) {
  locat_BOCD_1cp_out_same.all[[i]] <- BOCD_fixmw_out_1cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_1cp_out_same.all[[i]] <- locat_BOCD_1cp_out_same.all[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_out_1cp_param_same.all)) {
  plot(BOCD_fixmw_out_1cp_param_same.all[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_1cp_out_same.all, file = "../Output/CP_Detection/locat_BOCD_1cp_out_same.all.RDS")
```

2. PELT: Exact CPs Detection Method
```{r}
# detect the changepoints
PELT_fixmw_send_1cp_param_same.all <- list()
for (i in 1:length(fixmw_out_1cp_param_same.all)) {
  PELT_fixmw_send_1cp_param_same.all[[i]] <- cpt.meanvar(fixmw_send_1cp_param_same.all[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_1cp_send_same.all <- list()
for (i in 1:length(PELT_fixmw_send_1cp_param_same.all)) {
  locat_PELT_1cp_send_same.all[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_send_1cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_send_1cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_send_1cp_param_same.all)) {
  plot(PELT_fixmw_send_1cp_param_same.all[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_send_1cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_send_1cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_1cp_send_same.all, file = "../Output/CP_Detection/locat_PELT_1cp_send_same.all.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_diff_1cp_param_same.all <- list()
for (i in 1:length(fixmw_out_1cp_param_same.all)) {
  PELT_fixmw_diff_1cp_param_same.all[[i]] <- cpt.meanvar(fixmw_diff_1cp_param_same.all[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_1cp_diff_same.all <- list()
for (i in 1:length(PELT_fixmw_diff_1cp_param_same.all)) {
  locat_PELT_1cp_diff_same.all[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_diff_1cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_diff_1cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_diff_1cp_param_same.all)) {
  plot(PELT_fixmw_diff_1cp_param_same.all[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_diff_1cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_diff_1cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_1cp_diff_same.all, file = "../Output/CP_Detection/locat_PELT_1cp_diff_same.all.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_ine_1cp_param_same.all <- list()
for (i in 1:length(fixmw_out_1cp_param_same.all)) {
  PELT_fixmw_ine_1cp_param_same.all[[i]] <- cpt.meanvar(fixmw_ine_1cp_param_same.all[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_1cp_ine_same.all <- list()
for (i in 1:length(PELT_fixmw_ine_1cp_param_same.all)) {
  locat_PELT_1cp_ine_same.all[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_ine_1cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_ine_1cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_ine_1cp_param_same.all)) {
  plot(PELT_fixmw_ine_1cp_param_same.all[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_ine_1cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_ine_1cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_1cp_ine_same.all, file = "../Output/CP_Detection/locat_PELT_1cp_ine_same.all.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_out_1cp_param_same.all <- list()
for (i in 1:length(fixmw_out_1cp_param_same.all)) {
  PELT_fixmw_out_1cp_param_same.all[[i]] <- cpt.meanvar(fixmw_out_1cp_param_same.all[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_1cp_out_same.all <- list()
for (i in 1:length(PELT_fixmw_out_1cp_param_same.all)) {
  locat_PELT_1cp_out_same.all[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_out_1cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_out_1cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_out_1cp_param_same.all)) {
  plot(PELT_fixmw_out_1cp_param_same.all[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_out_1cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_out_1cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_1cp_out_same.all, file = "../Output/CP_Detection/locat_PELT_1cp_out_same.all.RDS")
```

3. BS: approximate CPs Detection Method
```{r}
# detect the changepoints
BS_fixmw_send_1cp_param_same.all <- list()
for (i in 1:length(fixmw_out_1cp_param_same.all)) {
  BS_fixmw_send_1cp_param_same.all[[i]] <- cpt.meanvar(fixmw_send_1cp_param_same.all[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_1cp_send_same.all <- list()
for (i in 1:length(BS_fixmw_send_1cp_param_same.all)) {
  locat_BS_1cp_send_same.all[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_send_1cp_param_same.all[[i]]@cpts[-length(BS_fixmw_send_1cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_send_1cp_param_same.all)) {
  plot(BS_fixmw_send_1cp_param_same.all[[i]], type="point", col = "black")
  abline(v=BS_fixmw_send_1cp_param_same.all[[i]]@cpts[-length(BS_fixmw_send_1cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_1cp_send_same.all, file = "../Output/CP_Detection/locat_BS_1cp_send_same.all.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_diff_1cp_param_same.all <- list()
for (i in 1:length(fixmw_out_1cp_param_same.all)) {
  BS_fixmw_diff_1cp_param_same.all[[i]] <- cpt.meanvar(fixmw_diff_1cp_param_same.all[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_1cp_diff_same.all <- list()
for (i in 1:length(BS_fixmw_diff_1cp_param_same.all)) {
  locat_BS_1cp_diff_same.all[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_diff_1cp_param_same.all[[i]]@cpts[-length(BS_fixmw_diff_1cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_diff_1cp_param_same.all)) {
  plot(BS_fixmw_diff_1cp_param_same.all[[i]], type="point", col = "black")
  abline(v=BS_fixmw_diff_1cp_param_same.all[[i]]@cpts[-length(BS_fixmw_diff_1cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_1cp_diff_same.all, file = "../Output/CP_Detection/locat_BS_1cp_diff_same.all.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_ine_1cp_param_same.all <- list()
for (i in 1:length(fixmw_out_1cp_param_same.all)) {
  BS_fixmw_ine_1cp_param_same.all[[i]] <- cpt.meanvar(fixmw_ine_1cp_param_same.all[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_1cp_ine_same.all <- list()
for (i in 1:length(BS_fixmw_ine_1cp_param_same.all)) {
  locat_BS_1cp_ine_same.all[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_ine_1cp_param_same.all[[i]]@cpts[-length(BS_fixmw_ine_1cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_ine_1cp_param_same.all)) {
  plot(BS_fixmw_ine_1cp_param_same.all[[i]], type="point", col = "black")
  abline(v=BS_fixmw_ine_1cp_param_same.all[[i]]@cpts[-length(BS_fixmw_ine_1cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_1cp_ine_same.all, file = "../Output/CP_Detection/locat_BS_1cp_ine_same.all.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_out_1cp_param_same.all <- list()
for (i in 1:length(fixmw_out_1cp_param_same.all)) {
  BS_fixmw_out_1cp_param_same.all[[i]] <- cpt.meanvar(fixmw_out_1cp_param_same.all[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_1cp_out_same.all <- list()
for (i in 1:length(BS_fixmw_out_1cp_param_same.all)) {
  locat_BS_1cp_out_same.all[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_out_1cp_param_same.all[[i]]@cpts[-length(BS_fixmw_out_1cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_out_1cp_param_same.all)) {
  plot(BS_fixmw_out_1cp_param_same.all[[i]], type="point", col = "black")
  abline(v=BS_fixmw_out_1cp_param_same.all[[i]]@cpts[-length(BS_fixmw_out_1cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_1cp_out_same.all, file = "../Output/CP_Detection/locat_BS_1cp_out_same.all.RDS")
```

# 2 Changepoints REH Data (inertia only)

**Read the Parameters given by windows**

Sender Effect:
```{r}
fixmw_send_2cp_param <- readRDS("../Data/Window_Parameters/fixmw_send_2cp_param.RDS")
```

Difference Effect: 
```{r}
fixmw_diff_2cp_param <- readRDS("../Data/Window_Parameters/fixmw_diff_2cp_param.RDS")
```

Inertia:
```{r}
fixmw_ine_2cp_param <- readRDS("../Data/Window_Parameters/fixmw_ine_2cp_param.RDS")
```

Out Degree Sender Effect:
```{r}
fixmw_out_2cp_param <- readRDS("../Data/Window_Parameters/fixmw_out_2cp_param.RDS")
```

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
# Detect the CPs
BOCD_fixmw_send_2cp_param <- list()
for (i in 1:length(fixmw_send_2cp_param)) {
  BOCD_fixmw_send_2cp_param[[i]] <- onlineCPD(fixmw_send_2cp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_2cp_send <- list()
for (i in 1:length(BOCD_fixmw_send_2cp_param)) {
  locat_BOCD_2cp_send[[i]] <- BOCD_fixmw_send_2cp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_2cp_send[[i]] <- locat_BOCD_2cp_send[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_send_2cp_param)) {
  plot(BOCD_fixmw_send_2cp_param[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_2cp_send, file = "../Output/CP_Detection/locat_BOCD_2cp_send.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_diff_2cp_param <- list()
for (i in 1:length(fixmw_diff_2cp_param)) {
  BOCD_fixmw_diff_2cp_param[[i]] <- onlineCPD(fixmw_diff_2cp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_2cp_diff <- list()
for (i in 1:length(BOCD_fixmw_diff_2cp_param)) {
  locat_BOCD_2cp_diff[[i]] <- BOCD_fixmw_diff_2cp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_2cp_diff[[i]] <- locat_BOCD_2cp_diff[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_diff_2cp_param)) {
  plot(BOCD_fixmw_diff_2cp_param[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_2cp_diff, file = "../Output/CP_Detection/locat_BOCD_2cp_diff.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_ine_2cp_param <- list()
for (i in 1:length(fixmw_ine_2cp_param)) {
  BOCD_fixmw_ine_2cp_param[[i]] <- onlineCPD(fixmw_ine_2cp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_2cp_ine <- list()
for (i in 1:length(BOCD_fixmw_ine_2cp_param)) {
  locat_BOCD_2cp_ine[[i]] <- BOCD_fixmw_ine_2cp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_2cp_ine[[i]] <- locat_BOCD_2cp_ine[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_ine_2cp_param)) {
  plot(BOCD_fixmw_ine_2cp_param[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_2cp_ine, file = "../Output/CP_Detection/locat_BOCD_2cp_ine.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_out_2cp_param <- list()
for (i in 1:length(fixmw_out_2cp_param)) {
  BOCD_fixmw_out_2cp_param[[i]] <- onlineCPD(fixmw_out_2cp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_2cp_out <- list()
for (i in 1:length(BOCD_fixmw_out_2cp_param)) {
  locat_BOCD_2cp_out[[i]] <- BOCD_fixmw_out_2cp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_2cp_out[[i]] <- locat_BOCD_2cp_out[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_out_2cp_param)) {
  plot(BOCD_fixmw_out_2cp_param[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_2cp_out, file = "../Output/CP_Detection/locat_BOCD_2cp_out.RDS")
```

2. PELT: Exact CPs Detection Method
```{r}
# detect the changepoints
PELT_fixmw_send_2cp_param <- list()
for (i in 1:length(fixmw_out_2cp_param)) {
  PELT_fixmw_send_2cp_param[[i]] <- cpt.meanvar(fixmw_send_2cp_param[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_2cp_send <- list()
for (i in 1:length(PELT_fixmw_send_2cp_param)) {
  locat_PELT_2cp_send[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_send_2cp_param[[i]]@cpts[-length(PELT_fixmw_send_2cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_send_2cp_param)) {
  plot(PELT_fixmw_send_2cp_param[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_send_2cp_param[[i]]@cpts[-length(PELT_fixmw_send_2cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_2cp_send, file = "../Output/CP_Detection/locat_PELT_2cp_send.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_diff_2cp_param <- list()
for (i in 1:length(fixmw_out_2cp_param)) {
  PELT_fixmw_diff_2cp_param[[i]] <- cpt.meanvar(fixmw_diff_2cp_param[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_2cp_diff <- list()
for (i in 1:length(PELT_fixmw_diff_2cp_param)) {
  locat_PELT_2cp_diff[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_diff_2cp_param[[i]]@cpts[-length(PELT_fixmw_diff_2cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_diff_2cp_param)) {
  plot(PELT_fixmw_diff_2cp_param[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_diff_2cp_param[[i]]@cpts[-length(PELT_fixmw_diff_2cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_2cp_diff, file = "../Output/CP_Detection/locat_PELT_2cp_diff.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_ine_2cp_param <- list()
for (i in 1:length(fixmw_out_2cp_param)) {
  PELT_fixmw_ine_2cp_param[[i]] <- cpt.meanvar(fixmw_ine_2cp_param[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_2cp_ine <- list()
for (i in 1:length(PELT_fixmw_ine_2cp_param)) {
  locat_PELT_2cp_ine[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_ine_2cp_param[[i]]@cpts[-length(PELT_fixmw_ine_2cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_ine_2cp_param)) {
  plot(PELT_fixmw_ine_2cp_param[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_ine_2cp_param[[i]]@cpts[-length(PELT_fixmw_ine_2cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_2cp_ine, file = "../Output/CP_Detection/locat_PELT_2cp_ine.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_out_2cp_param <- list()
for (i in 1:length(fixmw_out_2cp_param)) {
  PELT_fixmw_out_2cp_param[[i]] <- cpt.meanvar(fixmw_out_2cp_param[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_2cp_out <- list()
for (i in 1:length(PELT_fixmw_out_2cp_param)) {
  locat_PELT_2cp_out[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_out_2cp_param[[i]]@cpts[-length(PELT_fixmw_out_2cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_out_2cp_param)) {
  plot(PELT_fixmw_out_2cp_param[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_out_2cp_param[[i]]@cpts[-length(PELT_fixmw_out_2cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_2cp_out, file = "../Output/CP_Detection/locat_PELT_2cp_out.RDS")
```

3. BS: approximate CPs Detection Method
```{r}
# detect the changepoints
BS_fixmw_send_2cp_param <- list()
for (i in 1:length(fixmw_out_2cp_param)) {
  BS_fixmw_send_2cp_param[[i]] <- cpt.meanvar(fixmw_send_2cp_param[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_2cp_send <- list()
for (i in 1:length(BS_fixmw_send_2cp_param)) {
  locat_BS_2cp_send[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_send_2cp_param[[i]]@cpts[-length(BS_fixmw_send_2cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_send_2cp_param)) {
  plot(BS_fixmw_send_2cp_param[[i]], type="point", col = "black")
  abline(v=BS_fixmw_send_2cp_param[[i]]@cpts[-length(BS_fixmw_send_2cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_2cp_send, file = "../Output/CP_Detection/locat_BS_2cp_send.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_diff_2cp_param <- list()
for (i in 1:length(fixmw_out_2cp_param)) {
  BS_fixmw_diff_2cp_param[[i]] <- cpt.meanvar(fixmw_diff_2cp_param[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_2cp_diff <- list()
for (i in 1:length(BS_fixmw_diff_2cp_param)) {
  locat_BS_2cp_diff[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_diff_2cp_param[[i]]@cpts[-length(BS_fixmw_diff_2cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_diff_2cp_param)) {
  plot(BS_fixmw_diff_2cp_param[[i]], type="point", col = "black")
  abline(v=BS_fixmw_diff_2cp_param[[i]]@cpts[-length(BS_fixmw_diff_2cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_2cp_diff, file = "../Output/CP_Detection/locat_BS_2cp_diff.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_ine_2cp_param <- list()
for (i in 1:length(fixmw_out_2cp_param)) {
  BS_fixmw_ine_2cp_param[[i]] <- cpt.meanvar(fixmw_ine_2cp_param[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_2cp_ine <- list()
for (i in 1:length(BS_fixmw_ine_2cp_param)) {
  locat_BS_2cp_ine[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_ine_2cp_param[[i]]@cpts[-length(BS_fixmw_ine_2cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_ine_2cp_param)) {
  plot(BS_fixmw_ine_2cp_param[[i]], type="point", col = "black")
  abline(v=BS_fixmw_ine_2cp_param[[i]]@cpts[-length(BS_fixmw_ine_2cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_2cp_ine, file = "../Output/CP_Detection/locat_BS_2cp_ine.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_out_2cp_param <- list()
for (i in 1:length(fixmw_out_2cp_param)) {
  BS_fixmw_out_2cp_param[[i]] <- cpt.meanvar(fixmw_out_2cp_param[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_2cp_out <- list()
for (i in 1:length(BS_fixmw_out_2cp_param)) {
  locat_BS_2cp_out[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_out_2cp_param[[i]]@cpts[-length(BS_fixmw_out_2cp_param[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_out_2cp_param)) {
  plot(BS_fixmw_out_2cp_param[[i]], type="point", col = "black")
  abline(v=BS_fixmw_out_2cp_param[[i]]@cpts[-length(BS_fixmw_out_2cp_param[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_2cp_out, file = "../Output/CP_Detection/locat_BS_2cp_out.RDS")
```

# 2 Changepoints REH Data (all social interaction drivers at same locations)

Sender Effect:
```{r}
fixmw_send_2cp_param_same.all <- readRDS("../Data/Window_Parameters/fixmw_send_2cp_param_same.all.RDS")
```

Difference Effect: 
```{r}
fixmw_diff_2cp_param_same.all <- readRDS("../Data/Window_Parameters/fixmw_diff_2cp_param_same.all.RDS")
```

Inertia:
```{r}
fixmw_ine_2cp_param_same.all <- readRDS("../Data/Window_Parameters/fixmw_ine_2cp_param_same.all.RDS")
```

Out Degree Sender Effect:
```{r}
fixmw_out_2cp_param_same.all <- readRDS("../Data/Window_Parameters/fixmw_out_2cp_param_same.all.RDS")
```

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
# Detect the CPs
BOCD_fixmw_send_2cp_param_same.all <- list()
for (i in 1:length(fixmw_send_2cp_param_same.all)) {
  BOCD_fixmw_send_2cp_param_same.all[[i]] <- onlineCPD(fixmw_send_2cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_2cp_send_same.all <- list()
for (i in 1:length(BOCD_fixmw_send_2cp_param_same.all)) {
  locat_BOCD_2cp_send_same.all[[i]] <- BOCD_fixmw_send_2cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_2cp_send_same.all[[i]] <- locat_BOCD_2cp_send_same.all[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_send_2cp_param_same.all)) {
  plot(BOCD_fixmw_send_2cp_param_same.all[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_2cp_send_same.all, file = "../Output/CP_Detection/locat_BOCD_2cp_send_same.all.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_diff_2cp_param_same.all <- list()
for (i in 1:length(fixmw_diff_2cp_param_same.all)) {
  BOCD_fixmw_diff_2cp_param_same.all[[i]] <- onlineCPD(fixmw_diff_2cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_2cp_diff_same.all <- list()
for (i in 1:length(BOCD_fixmw_diff_2cp_param_same.all)) {
  locat_BOCD_2cp_diff_same.all[[i]] <- BOCD_fixmw_diff_2cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_2cp_diff_same.all[[i]] <- locat_BOCD_2cp_diff_same.all[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_diff_2cp_param_same.all)) {
  plot(BOCD_fixmw_diff_2cp_param_same.all[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_2cp_diff_same.all, file = "../Output/CP_Detection/locat_BOCD_2cp_diff_same.all.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_ine_2cp_param_same.all <- list()
for (i in 1:length(fixmw_ine_2cp_param_same.all)) {
  BOCD_fixmw_ine_2cp_param_same.all[[i]] <- onlineCPD(fixmw_ine_2cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_2cp_ine_same.all <- list()
for (i in 1:length(BOCD_fixmw_ine_2cp_param_same.all)) {
  locat_BOCD_2cp_ine_same.all[[i]] <- BOCD_fixmw_ine_2cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_2cp_ine_same.all[[i]] <- locat_BOCD_2cp_ine_same.all[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_ine_2cp_param_same.all)) {
  plot(BOCD_fixmw_ine_2cp_param_same.all[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_2cp_ine_same.all, file = "../Output/CP_Detection/locat_BOCD_2cp_ine_same.all.RDS")
```

```{r}
# Detect the CPs
BOCD_fixmw_out_2cp_param_same.all <- list()
for (i in 1:length(fixmw_out_2cp_param_same.all)) {
  BOCD_fixmw_out_2cp_param_same.all[[i]] <- onlineCPD(fixmw_out_2cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_2cp_out_same.all <- list()
for (i in 1:length(BOCD_fixmw_out_2cp_param_same.all)) {
  locat_BOCD_2cp_out_same.all[[i]] <- BOCD_fixmw_out_2cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_BOCD_2cp_out_same.all[[i]] <- locat_BOCD_2cp_out_same.all[[i]][-1]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_out_2cp_param_same.all)) {
  plot(BOCD_fixmw_out_2cp_param_same.all[[i]])
}
```

```{r}
saveRDS(object = locat_BOCD_2cp_out_same.all, file = "../Output/CP_Detection/locat_BOCD_2cp_out_same.all.RDS")
```

2. PELT: Exact CPs Detection Method
```{r}
# detect the changepoints
PELT_fixmw_send_2cp_param_same.all <- list()
for (i in 1:length(fixmw_out_2cp_param_same.all)) {
  PELT_fixmw_send_2cp_param_same.all[[i]] <- cpt.meanvar(fixmw_send_2cp_param_same.all[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_2cp_send_same.all <- list()
for (i in 1:length(PELT_fixmw_send_2cp_param_same.all)) {
  locat_PELT_2cp_send_same.all[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_send_2cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_send_2cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_send_2cp_param_same.all)) {
  plot(PELT_fixmw_send_2cp_param_same.all[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_send_2cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_send_2cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_2cp_send_same.all, file = "../Output/CP_Detection/locat_PELT_2cp_send_same.all.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_diff_2cp_param_same.all <- list()
for (i in 1:length(fixmw_out_2cp_param_same.all)) {
  PELT_fixmw_diff_2cp_param_same.all[[i]] <- cpt.meanvar(fixmw_diff_2cp_param_same.all[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_2cp_diff_same.all <- list()
for (i in 1:length(PELT_fixmw_diff_2cp_param_same.all)) {
  locat_PELT_2cp_diff_same.all[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_diff_2cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_diff_2cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_diff_2cp_param_same.all)) {
  plot(PELT_fixmw_diff_2cp_param_same.all[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_diff_2cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_diff_2cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_2cp_diff_same.all, file = "../Output/CP_Detection/locat_PELT_2cp_diff_same.all.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_ine_2cp_param_same.all <- list()
for (i in 1:length(fixmw_out_2cp_param_same.all)) {
  PELT_fixmw_ine_2cp_param_same.all[[i]] <- cpt.meanvar(fixmw_ine_2cp_param_same.all[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_2cp_ine_same.all <- list()
for (i in 1:length(PELT_fixmw_ine_2cp_param_same.all)) {
  locat_PELT_2cp_ine_same.all[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_ine_2cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_ine_2cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_ine_2cp_param_same.all)) {
  plot(PELT_fixmw_ine_2cp_param_same.all[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_ine_2cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_ine_2cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_2cp_ine_same.all, file = "../Output/CP_Detection/locat_PELT_2cp_ine_same.all.RDS")
```

```{r}
# detect the changepoints
PELT_fixmw_out_2cp_param_same.all <- list()
for (i in 1:length(fixmw_out_2cp_param_same.all)) {
  PELT_fixmw_out_2cp_param_same.all[[i]] <- cpt.meanvar(fixmw_out_2cp_param_same.all[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_2cp_out_same.all <- list()
for (i in 1:length(PELT_fixmw_out_2cp_param_same.all)) {
  locat_PELT_2cp_out_same.all[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_out_2cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_out_2cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(PELT_fixmw_out_2cp_param_same.all)) {
  plot(PELT_fixmw_out_2cp_param_same.all[[i]], type="point", col = "black")
  abline(v=PELT_fixmw_out_2cp_param_same.all[[i]]@cpts[-length(PELT_fixmw_out_2cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_PELT_2cp_out_same.all, file = "../Output/CP_Detection/locat_PELT_2cp_out_same.all.RDS")
```

3. BS: approximate CPs Detection Method
```{r}
# detect the changepoints
BS_fixmw_send_2cp_param_same.all <- list()
for (i in 1:length(fixmw_out_2cp_param_same.all)) {
  BS_fixmw_send_2cp_param_same.all[[i]] <- cpt.meanvar(fixmw_send_2cp_param_same.all[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_2cp_send_same.all <- list()
for (i in 1:length(BS_fixmw_send_2cp_param_same.all)) {
  locat_BS_2cp_send_same.all[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_send_2cp_param_same.all[[i]]@cpts[-length(BS_fixmw_send_2cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_send_2cp_param_same.all)) {
  plot(BS_fixmw_send_2cp_param_same.all[[i]], type="point", col = "black")
  abline(v=BS_fixmw_send_2cp_param_same.all[[i]]@cpts[-length(BS_fixmw_send_2cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_2cp_send_same.all, file = "../Output/CP_Detection/locat_BS_2cp_send_same.all.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_diff_2cp_param_same.all <- list()
for (i in 1:length(fixmw_out_2cp_param_same.all)) {
  BS_fixmw_diff_2cp_param_same.all[[i]] <- cpt.meanvar(fixmw_diff_2cp_param_same.all[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_2cp_diff_same.all <- list()
for (i in 1:length(BS_fixmw_diff_2cp_param_same.all)) {
  locat_BS_2cp_diff_same.all[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_diff_2cp_param_same.all[[i]]@cpts[-length(BS_fixmw_diff_2cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_diff_2cp_param_same.all)) {
  plot(BS_fixmw_diff_2cp_param_same.all[[i]], type="point", col = "black")
  abline(v=BS_fixmw_diff_2cp_param_same.all[[i]]@cpts[-length(BS_fixmw_diff_2cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_2cp_diff_same.all, file = "../Output/CP_Detection/locat_BS_2cp_diff_same.all.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_ine_2cp_param_same.all <- list()
for (i in 1:length(fixmw_out_2cp_param_same.all)) {
  BS_fixmw_ine_2cp_param_same.all[[i]] <- cpt.meanvar(fixmw_ine_2cp_param_same.all[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_2cp_ine_same.all <- list()
for (i in 1:length(BS_fixmw_ine_2cp_param_same.all)) {
  locat_BS_2cp_ine_same.all[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_ine_2cp_param_same.all[[i]]@cpts[-length(BS_fixmw_ine_2cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_ine_2cp_param_same.all)) {
  plot(BS_fixmw_ine_2cp_param_same.all[[i]], type="point", col = "black")
  abline(v=BS_fixmw_ine_2cp_param_same.all[[i]]@cpts[-length(BS_fixmw_ine_2cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_2cp_ine_same.all, file = "../Output/CP_Detection/locat_BS_2cp_ine_same.all.RDS")
```

```{r}
# detect the changepoints
BS_fixmw_out_2cp_param_same.all <- list()
for (i in 1:length(fixmw_out_2cp_param_same.all)) {
  BS_fixmw_out_2cp_param_same.all[[i]] <- cpt.meanvar(fixmw_out_2cp_param_same.all[[i]], method="BinSeg")
}

# location of the changepoints
locat_BS_2cp_out_same.all <- list()
for (i in 1:length(BS_fixmw_out_2cp_param_same.all)) {
  locat_BS_2cp_out_same.all[[i]] <- 
    # remove the last value of the vector, as BS function indicates the last window as CP all the time
    BS_fixmw_out_2cp_param_same.all[[i]]@cpts[-length(BS_fixmw_out_2cp_param_same.all[[i]]@cpts)]
}

# plot the location of CPs
for (i in 1:length(BS_fixmw_out_2cp_param_same.all)) {
  plot(BS_fixmw_out_2cp_param_same.all[[i]], type="point", col = "black")
  abline(v=BS_fixmw_out_2cp_param_same.all[[i]]@cpts[-length(BS_fixmw_out_2cp_param_same.all[[i]]@cpts)], col="black")
}
```

```{r}
saveRDS(object = locat_BS_2cp_out_same.all, file = "../Output/CP_Detection/locat_BS_2cp_out_same.all.RDS")
```




--------------------------------------------------------------------------------

# Visualization: an example of the fluctuations of effects (the first dataset from the "all effects has one changepoint" condition)

```{r}
library(tidyverse)
library(lubridate)
library(RColorBrewer)
library(ggforce) # add bracket under the window line
library(patchwork) # combine many plots into one
```


```{r fig.height= 3.75, fig.width=9}
example_plot <- data.frame("window" = 1:length(fixmw_send_1cp_param_same.all[[1]]),
                           "sender" = fixmw_send_1cp_param_same.all[[1]],
                           "difference" = fixmw_diff_1cp_param_same.all[[1]],
                           "inertia" = fixmw_ine_1cp_param_same.all[[1]],
                           "outdegreesender" = fixmw_out_1cp_param_same.all[[1]])

sender_plot <- 
  ggplot(example_plot, aes(x = window, y = sender)) +
  geom_point(color = "#4d495a", size = 1.05) +
  labs(title = "Sender",
       x = "Window", 
       y = "Parameter") +
  theme_bw() +
  theme(plot.title = element_text(face = "italic", family = "serif"),
        axis.text = element_text(family = "serif"),
        axis.title = element_text(family = "serif"),
        legend.position = "none",
        legend.text = element_text(family = "serif"),
        legend.title = element_text(face = "italic", family = "serif"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
  geom_rect(aes(xmin = 56, xmax = 58,
                ymin = -Inf, ymax = Inf),
            fill = "#D6C1DE", alpha = 0.03) +
  geom_vline(xintercept = 56, linetype = "dashed", color = "black") +
  geom_vline(xintercept = 58, linetype = "dashed", color = "black")

sender_plot

difference_plot <- 
  ggplot(example_plot, aes(x = window, y = difference)) +
  geom_point(color = "#4d495a", size = 1.05) +
  labs(title = "Difference",
       x = "Window", 
       y = "Parameter") +
  theme_bw() +
  theme(plot.title = element_text(face = "italic", family = "serif"),
        axis.text = element_text(family = "serif"),
        axis.title = element_text(family = "serif"),
        legend.position = "none",
        legend.text = element_text(family = "serif"),
        legend.title = element_text(face = "italic", family = "serif"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
  geom_rect(aes(xmin = 56, xmax = 58,
                ymin = -Inf, ymax = Inf),
            fill = "#D6C1DE", alpha = 0.03) +
  geom_vline(xintercept = 56, linetype = "dashed", color = "black") +
  geom_vline(xintercept = 58, linetype = "dashed", color = "black")

difference_plot

inertia_plot <- 
  ggplot(example_plot, aes(x = window, y = inertia)) +
  geom_point(color = "#4d495a", size = 1.05) +
  labs(title = "Inertia",
       x = "Window", 
       y = "Parameter") +
  theme_bw() +
  theme(plot.title = element_text(face = "italic", family = "serif"),
        axis.text = element_text(family = "serif"),
        axis.title = element_text(family = "serif"),
        legend.position = "none",
        legend.text = element_text(family = "serif"),
        legend.title = element_text(face = "italic", family = "serif"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
  geom_rect(aes(xmin = 56, xmax = 58,
                ymin = -Inf, ymax = Inf),
            fill = "#D6C1DE", alpha = 0.03) +
  geom_vline(xintercept = 56, linetype = "dashed", color = "black") +
  geom_vline(xintercept = 58, linetype = "dashed", color = "black")

inertia_plot

outdegreesender_plot <- 
  ggplot(example_plot, aes(x = window, y = outdegreesender)) +
  geom_point(color = "#4d495a", size = 1.05) +
  labs(title = "OutdegreeSender",
       x = "Window", 
       y = "Parameter") +
  theme_bw() +
  theme(plot.title = element_text(face = "italic", family = "serif"),
        axis.text = element_text(family = "serif"),
        axis.title = element_text(family = "serif"),
        legend.position = "none",
        legend.text = element_text(family = "serif"),
        legend.title = element_text(face = "italic", family = "serif"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
  geom_rect(aes(xmin = 56, xmax = 58,
                ymin = -Inf, ymax = Inf),
            fill = "#D6C1DE", alpha = 0.03) +
  geom_vline(xintercept = 56, linetype = "dashed", color = "black") +
  geom_vline(xintercept = 58, linetype = "dashed", color = "black")

outdegreesender_plot



sender_plot +
  difference_plot + 
  inertia_plot +
  outdegreesender_plot +
  plot_layout(ncol = 2, widths = c(1,1))
```
